{% extends "base.html" %}
{% import 'components/components.html' as components %}
{% set my_class = leapi.name2class(classname) %}
{% set objects = my_class.get(('lodel_id = %s') % (lodel_id)) %}
{% set obj = objects.pop() %}
{% if my_class.is_abstract() %}
{% set classname = obj.data('classname') %}
{% set my_class = my_class.name2class(classname) %}
{% endif %}
{% block title %}Lodel 2 - Object {{ lodel_id }} {% endblock %}
{% import "components/components.html" as components %}
{% block content %}
<h1>Lodel 2 - {{ classname }} with uid {{ lodel_id }}</h1>
    
<ul>
    <!-- To get a component HTML code, it is necessary to call : components.<macro_name>(args) -->
    {% for fieldname, fieldvalue in obj.fields().items() %}
        {% if fieldvalue is not none %}
           {% if fieldvalue.base_type == 'ref' %}
                {% if obj.data(fieldname) is iterable %}
                    <li>{{ fieldname }}
                        <ul>
                    {% for rel in obj.data(fieldname) %}
                            {% set l_classe = fieldvalue.linked_classes %}
                            <li><a href="show_object?classname={{ l_classe.__name__ }}&lodel_id={{ rel|int }}" target="_blank">{{ rel|int }}</a></li>
                    {% endfor %}
                        </ul></li>
                {% endif %}
            {% else %}
                <li> {{ fieldname }} : {{ obj.data(fieldname) }} </li>
            {% endif %}
        {% endif %}
    {% endfor %}
</ul>
{% endblock %}
